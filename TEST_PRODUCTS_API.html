<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ø®ØªØ¨Ø§Ø± API Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 20px;
            background: #f5f5f5;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .product {
            border: 1px solid #ddd;
            margin: 10px 0;
            padding: 15px;
            border-radius: 8px;
            background: #f9f9f9;
        }
        .product h3 {
            margin: 0 0 10px 0;
            color: #333;
        }
        .product p {
            margin: 5px 0;
            color: #666;
        }
        button {
            background: #007cba;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }
        button:hover {
            background: #005a87;
        }
        .loading {
            text-align: center;
            color: #666;
            font-style: italic;
        }
        .error {
            color: red;
            background: #ffe6e6;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }
        .success {
            color: green;
            background: #e6ffe6;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ”§ Ø§Ø®ØªØ¨Ø§Ø± API Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª - Ù†Ø¸Ø§Ù… ØµÙŠØ§Ù†Ø© HOTWAV</h1>
        
        <button onclick="testProductsAPI()">Ø¬Ù„Ø¨ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ù…Ù† API</button>
        
        <div id="status"></div>
        <div id="results"></div>
    </div>

    <script>
        const API_BASE = 'http://localhost:5000/api'; // ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„ØµØ­ÙŠØ­
        
        async function testProductsAPI() {
            const statusDiv = document.getElementById('status');
            const resultsDiv = document.getElementById('results');
            
            statusDiv.innerHTML = '<div class="loading">ğŸ”„ Ø¬Ø§Ø±ÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª...</div>';
            resultsDiv.innerHTML = '';
            
            try {
                console.log('ğŸ”„ Fetching products from:', `${API_BASE}/products`);
                
                const response = await fetch(`${API_BASE}/products?limit=1000`);
                console.log('ğŸ“¡ Response status:', response.status);
                console.log('ğŸ“¡ Response headers:', response.headers);
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const data = await response.json();
                console.log('ğŸ“¦ Raw response data:', data);
                
                // Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ù‡ÙŠÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø®ØªÙ„Ù
                let products = [];
                if (Array.isArray(data)) {
                    products = data;
                } else if (data.products && Array.isArray(data.products)) {
                    products = data.products;
                } else if (data.data && Array.isArray(data.data)) {
                    products = data.data;
                } else if (data.success && data.products) {
                    products = data.products;
                }
                
                console.log('ğŸ“¦ Processed products:', products);
                console.log('ğŸ“¦ Products count:', products.length);
                
                if (products.length === 0) {
                    statusDiv.innerHTML = '<div class="error">âŒ Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù†ØªØ¬Ø§Øª ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</div>';
                    return;
                }
                
                statusDiv.innerHTML = `<div class="success">âœ… ØªÙ… Ø¬Ù„Ø¨ ${products.length} Ù…Ù†ØªØ¬ Ø¨Ù†Ø¬Ø§Ø­!</div>`;
                
                // Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª
                let html = '<h2>ğŸ“± Ù‚Ø§Ø¦Ù…Ø© Ø£Ø¬Ù‡Ø²Ø© HOTWAV:</h2>';
                products.forEach((product, index) => {
                    const name = product.nameAr || product.name?.ar || product.name || product.title || `Ù…Ù†ØªØ¬ ${index + 1}`;
                    const price = product.price || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯';
                    const brand = product.brand || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯';
                    const category = product.category?.nameAr || product.category?.name?.ar || product.categoryName || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯';
                    
                    html += `
                        <div class="product">
                            <h3>ğŸ“± ${name}</h3>
                            <p><strong>Ø§Ù„Ø¹Ù„Ø§Ù…Ø© Ø§Ù„ØªØ¬Ø§Ø±ÙŠØ©:</strong> ${brand}</p>
                            <p><strong>Ø§Ù„ÙØ¦Ø©:</strong> ${category}</p>
                            <p><strong>Ø§Ù„Ø³Ø¹Ø±:</strong> ${price} Ø±ÙŠØ§Ù„</p>
                            <p><strong>ID:</strong> ${product._id || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</p>
                            <p><strong>Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø®Ø§Ù…:</strong></p>
                            <pre style="background: #f0f0f0; padding: 10px; border-radius: 5px; font-size: 12px; overflow-x: auto;">${JSON.stringify(product, null, 2)}</pre>
                        </div>
                    `;
                });
                
                resultsDiv.innerHTML = html;
                
            } catch (error) {
                console.error('âŒ Error:', error);
                statusDiv.innerHTML = `<div class="error">âŒ Ø®Ø·Ø£: ${error.message}</div>`;
                
                // Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© Ù„Ù„ØªØ´Ø®ÙŠØµ
                resultsDiv.innerHTML = `
                    <h3>ğŸ” Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØªØ´Ø®ÙŠØµ:</h3>
                    <p><strong>Ø±Ø§Ø¨Ø· API:</strong> ${API_BASE}/products</p>
                    <p><strong>Ù†ÙˆØ¹ Ø§Ù„Ø®Ø·Ø£:</strong> ${error.name}</p>
                    <p><strong>Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø®Ø·Ø£:</strong> ${error.message}</p>
                    <p><strong>ØªØ£ÙƒØ¯ Ù…Ù†:</strong></p>
                    <ul>
                        <li>ØªØ´ØºÙŠÙ„ Ø§Ù„Ø®Ø§Ø¯Ù… Ø§Ù„Ø®Ù„ÙÙŠ (Backend)</li>
                        <li>ØµØ­Ø© Ø±Ø§Ø¨Ø· API</li>
                        <li>ÙˆØ¬ÙˆØ¯ Ù…Ù†ØªØ¬Ø§Øª ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</li>
                        <li>Ø¹Ø¯Ù… ÙˆØ¬ÙˆØ¯ Ù…Ø´Ø§ÙƒÙ„ CORS</li>
                    </ul>
                `;
            }
        }
        
        // Ø§Ø®ØªØ¨Ø§Ø± ØªÙ„Ù‚Ø§Ø¦ÙŠ Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
        window.onload = function() {
            console.log('ğŸš€ ØµÙØ­Ø© Ø§Ø®ØªØ¨Ø§Ø± API Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø¬Ø§Ù‡Ø²Ø©');
            console.log('ğŸ”— API Base URL:', API_BASE);
        };
    </script>
</body>
</html>