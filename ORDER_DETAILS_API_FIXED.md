# إصلاح API تفاصيل الطلب

## المشكلة
كان هناك خطأ 500 في الخادم عند محاولة جلب تفاصيل الطلب من خلال رقم الطلب (orderNumber).

## السبب
دالة `getOrderById` كانت تبحث عن الطلب باستخدام `_id` فقط، بينما صفحة الحساب ترسل `orderNumber` في الرابط.

## الحل المطبق
تم تحديث دالة `getOrderById` للبحث بواسطة `orderNumber` أو `_id`:

```javascript
let order = await Order.findOne({
  $or: [
    { orderNumber: id },
    { _id: id }
  ]
}).populate('user', 'name nameAr email phone');
```

## المميزات الجديدة
- **مرونة في البحث**: يمكن الوصول للطلب بواسطة رقم الطلب أو معرف قاعدة البيانات
- **توافق مع الروابط الموجودة**: يعمل مع الروابط التي تستخدم `orderNumber`
- **حماية محسنة**: نفس مستوى الحماية والتحقق من الصلاحيات

## النتيجة
- ✅ صفحة تفاصيل الطلب تعمل بشكل صحيح
- ✅ العميل يمكنه رؤية تفاصيل طلباته
- ✅ الحماية والأمان محفوظان
- ✅ دعم كامل لجميع أنواع المعرفات

## الملفات المحدثة
- `backend/controllers/orderController.js` - تحديث دالة getOrderById

## الاستخدام
الآن يمكن الوصول لتفاصيل الطلب بواسطة:
- `/api/orders/ORD-1766429381174-6` (orderNumber)
- `/api/orders/507f1f77bcf86cd799439011` (_id)