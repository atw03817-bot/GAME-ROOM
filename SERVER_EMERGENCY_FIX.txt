# إصلاح طارئ للسيرفر - نسخ ولصق

# 1. سحب التحديثات
cd ~/mobile-store-vite
git pull origin main

# 2. تحقق من حالة MongoDB
sudo systemctl status mongodb

# 3. إذا MongoDB مش شغال، شغله
sudo systemctl start mongodb
sudo systemctl enable mongodb

# 4. إذا MongoDB مش مثبت، ثبته
sudo apt update
sudo apt install mongodb -y
sudo systemctl start mongodb

# 5. تحقق من ملف .env
cd ~/mobile-store-vite/backend
cat .env

# 6. إذا MONGODB_URI مش صحيح، اصلحه
echo "MONGODB_URI=mongodb://localhost:27017/mobile_store" > .env
echo "PORT=5000" >> .env
echo "NODE_ENV=production" >> .env
echo "FRONTEND_URL=https://www.ab-tw.com" >> .env
echo "JWT_SECRET=mobile-store-secret-2025" >> .env

# 7. إيقاف العمليات القديمة
pm2 delete all
sudo fuser -k 5000/tcp

# 8. تشغيل Backend
cd ~/mobile-store-vite/backend
pm2 start server.js --name mobile-store-backend

# 9. تحقق من الحالة
pm2 status
pm2 logs mobile-store-backend --lines 20

# 10. اختبار
curl http://localhost:5000/api/products