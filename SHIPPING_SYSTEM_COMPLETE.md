# نظام الشحن لطلبات الصيانة - مكتمل

## المميزات المضافة:

### 1. اختيار شركة الشحن للعملاء
✅ **تم الإضافة**: قسم اختيار شركة الشحن في صفحة طلب الصيانة
- 3 شركات شحن متاحة: أرامكس (25 ريال)، سمسا (20 ريال)، ناقل (22 ريال)
- عرض الأسعار والأوقات المتوقعة لكل شركة
- خيار "لا أحتاج شحن" للعملاء المحليين

### 2. معلومات الشحن المطلوبة
✅ **تم الإضافة**: حقول إضافية عند اختيار الشحن:
- عنوان استلام الجهاز من العميل
- تنبيهات مهمة عن عملية الشحن
- شرح أن الشركة ستتواصل مع العميل

### 3. تحديث قاعدة البيانات
✅ **تم التحديث**: إضافة قسم `shipping` في MaintenanceRequest model:
- `isRequired`: هل يحتاج شحن
- `provider`: شركة الشحن (aramex, smsa, naqel)
- `providerName`: اسم الشركة بالعربي
- `cost`: تكلفة الشحن
- `trackingNumber`: رقم التتبع
- `status`: حالة الشحن
- `pickupAddress`: عنوان الاستلام
- `deliveryAddress`: عنوان التسليم

### 4. تحديث حساب التكلفة
✅ **تم التحديث**: إضافة `shippingFee` في حساب التكلفة الإجمالية
- رسوم الشحن تُضاف تلقائياً للفاتورة
- تظهر في ملخص التكلفة للعميل والإدارة

### 5. عرض معلومات الشحن
✅ **تم الإضافة**: قسم معلومات الشحن في صفحات التفاصيل:
- صفحة تفاصيل الطلب للعميل
- صفحة تفاصيل الطلب للإدارة
- عرض شركة الشحن المختارة وتكلفتها
- حالة الشحن وتتبع الطلب

### 6. تحديث Backend
✅ **تم التحديث**: دالة `createMaintenanceRequest` لحفظ معلومات الشحن
- حفظ بيانات الشحن مع الطلب
- حساب رسوم الشحن تلقائياً
- إضافة ملاحظة في تاريخ الطلب عن الشحن

## شركات الشحن المتاحة:

1. **أرامكس**: 25 ريال - التسليم خلال 2-3 أيام عمل
2. **سمسا إكسبرس**: 20 ريال - التسليم خلال 3-4 أيام عمل  
3. **ناقل إكسبرس**: 22 ريال - التسليم خلال 2-4 أيام عمل

## سير العمل:

1. **العميل يطلب صيانة**:
   - يختار "نعم، أحتاج خدمة الشحن"
   - يختار شركة الشحن المفضلة
   - يدخل عنوان الاستلام التفصيلي
   - رسوم الشحن تُضاف للتكلفة الإجمالية

2. **الإدارة تعالج الطلب**:
   - تشاهد شركة الشحن المختارة في تفاصيل الطلب
   - تُرسل بوليصة الشحن للعميل
   - تتابع حالة الشحن وتحديث رقم التتبع

3. **العميل يتابع الطلب**:
   - يشاهد معلومات الشحن في صفحة التفاصيل
   - يحصل على رقم التتبع عند توفره
   - يتلقى تحديثات عن حالة الشحن

## الملفات المحدثة:

### Backend:
- `backend/models/MaintenanceRequest.js` - إضافة قسم الشحن
- `backend/controllers/maintenanceController.js` - تحديث دالة الإنشاء

### Frontend:
- `frontend/src/pages/MaintenanceRequest.jsx` - إضافة قسم اختيار الشحن
- `frontend/src/pages/admin/MaintenanceDetails.jsx` - عرض معلومات الشحن
- `frontend/src/pages/MaintenanceRequestDetails.jsx` - عرض معلومات الشحن

## الاختبار:
شغل `TEST_SHIPPING_SYSTEM.bat` لاختبار النظام الجديد

النظام الآن جاهز ويدعم خدمة الشحن للعملاء خارج المدينة مع عرض الأسعار وتتبع الطلبات!